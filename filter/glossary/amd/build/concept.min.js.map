{"version":3,"sources":["../src/concept.js"],"names":["define","$","ModalFactory","ModalEvents","Fragment","SELECTOR","CONCEPT","isInitialised","showConceptModal","triggerElement","contextId","params","eid","data","create","title","attr","body","loadFragment","large","done","modal","getRoot","on","hidden","destroy","show","fail","Notification","exception","init","document","e","preventDefault","currentTarget"],"mappings":"AAwBAA,OAAM,2BAAC,CAAC,QAAD,CACC,oBADD,CAEC,mBAFD,CAGC,eAHD,CAAD,CAIN,SAASC,CAAT,CAAYC,CAAZ,CAA0BC,CAA1B,CAAuCC,CAAvC,CAAiD,IAKzCC,CAAAA,CAAQ,CAAG,CACXC,OAAO,CAAE,6BADE,CAL8B,CAYzCC,CAAa,GAZ4B,CAoBzCC,CAAgB,CAAG,SAASC,CAAT,CAAyBC,CAAzB,CAAoC,CACvD,GAAIC,CAAAA,CAAM,CAAG,CAACC,GAAG,CAAEH,CAAc,CAACI,IAAf,CAAoB,KAApB,CAAN,CAAb,CACAX,CAAY,CAACY,MAAb,CAAoB,CAChBC,KAAK,CAAEN,CAAc,CAACO,IAAf,CAAoB,OAApB,CADS,CAEhBC,IAAI,CAAEb,CAAQ,CAACc,YAAT,CAAsB,iBAAtB,CAAyC,aAAzC,CAAwDR,CAAxD,CAAmEC,CAAnE,CAFU,CAGhBQ,KAAK,GAHW,CAApB,CAIGV,CAJH,EAImBW,IAJnB,CAIwB,SAASC,CAAT,CAAgB,CAEpCA,CAAK,CAACC,OAAN,GAAgBC,EAAhB,CAAmBpB,CAAW,CAACqB,MAA/B,CAAuC,UAAW,CAC9CH,CAAK,CAACI,OAAN,EACH,CAFD,EAGAJ,CAAK,CAACK,IAAN,GACA,MAAO,KACV,CAXD,EAWGC,IAXH,CAWQC,YAAY,CAACC,SAXrB,CAYH,CAlC4C,CAoC7C,MAA6C,CAOzCC,IAAI,CAAE,cAASpB,CAAT,CAAoB,CACtB,GAAI,CAACH,CAAL,CAAoB,CAChBN,CAAC,CAAC8B,QAAQ,CAACd,IAAV,CAAD,CAAiBM,EAAjB,CAAoB,OAApB,CAA6BlB,CAAQ,CAACC,OAAtC,CAA+C,SAAS0B,CAAT,CAAY,CACvDA,CAAC,CAACC,cAAF,GACAzB,CAAgB,CAACP,CAAC,CAAC+B,CAAC,CAACE,aAAH,CAAF,CAAqBxB,CAArB,CACnB,CAHD,EAIAH,CAAa,GAChB,CACJ,CAfwC,CAiBhD,CAzDK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Display autolinked glossary concept in modal.\n *\n * @module     filter_glossary/concept\n * @package    filter_glossary\n * @copyright  2019 Ruslan Kabalin\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery',\n        'core/modal_factory',\n        'core/modal_events',\n        'core/fragment'],\nfunction($, ModalFactory, ModalEvents, Fragment) {\n\n    /**\n     * Element selectors.\n     */\n    var SELECTOR = {\n        CONCEPT: \"a.glossary.autolink.concept\"\n    };\n\n    /**\n     * Flag to prevent same event attachment multiple times.\n     */\n    var isInitialised = false;\n\n    /**\n     * Modal with glossary concept.\n     *\n     * @param {jQuery} triggerElement\n     * @param {Number} contextId\n     */\n    var showConceptModal = function(triggerElement, contextId) {\n        var params = {eid: triggerElement.data('eid')};\n        ModalFactory.create({\n            title: triggerElement.attr('title'),\n            body: Fragment.loadFragment('filter_glossary', 'get_concept', contextId, params),\n            large: true,\n        }, triggerElement).done(function(modal) {\n            // When we close the dialogue by clicking on X in the top right corner.\n            modal.getRoot().on(ModalEvents.hidden, function() {\n                modal.destroy();\n            });\n            modal.show();\n            return null;\n        }).fail(Notification.exception);\n    };\n\n    return /** @alias filter_glossary/concept */ {\n\n        /**\n         * Initialise the page.\n         *\n         * @param {Number} contextId\n         */\n        init: function(contextId) {\n            if (!isInitialised) {\n                $(document.body).on('click', SELECTOR.CONCEPT, function(e) {\n                    e.preventDefault();\n                    showConceptModal($(e.currentTarget), contextId);\n                });\n                isInitialised = true;\n            }\n        }\n    };\n});\n"],"file":"concept.min.js"}